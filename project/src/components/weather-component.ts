import * as bodyParser from "body-parser"
import { html, render } from "lit-html"
import { DAY_SELECTED_EVENT } from ".."
import { WeatherData } from "../model/weatherData"
import geoService, { GeoService } from "../services/geo-service"
import weatherService from "../services/weather-service"


const template = html`
    <div>
        <table>
            <thead>
            <tr>
                <th id='${new Date(new Date().getDay() - 1 == 0 ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours() >=10 ? new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).toISOString().split('T')[0]+'T'+new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours()+':00' : new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours()+':00'}'>Monatg</th>
                <th id='${((new Date().getDay() - 2 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours()+':00')}'>Dienstag</th>
                <th id='${((new Date().getDay() - 3 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours()+':00')}'>Mittwoch</th>
                <th id='${((new Date().getDay() - 4 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours()+':00')}'>Donnerstag</th>
                <th id='${((new Date().getDay() - 5 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours()+':00')}'>Freitag</th>
                <th id='${((new Date().getDay() - 6 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours()+':00')}'>Samstag</th>
                <th id='${((new Date().getDay() - 6 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours()+':00')}'>Sonntag</th>
            </tr>
            </thead>

            <tbody>
            </tbody>
        </table>
        
    </div>
` 

const rowTemplate = (data: WeatherData) => html`
<td style="text-align:center" id='${new Date(new Date().getDay() - 1 == 0 ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours() >=10 ? new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).toISOString().split('T')[0]+'T'+new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours()+':00' : new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours()+':00'}' ><img witdh="100"  height="100" src="src/model/img/${data.hourly.weathercode[data.hourly.time.indexOf(new Date(new Date().getDay() - 1 == 0 ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours() >=10 ? new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).toISOString().split('T')[0]+'T'+new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours()+':00' : new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours()+':00')]}.JPG"> <br> ${new Date(new Date().getDay() - 1 == 0 ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours() >=10 ? new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).toISOString().split('T')[0]+'T'+new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours()+':00' : new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getDay() - 1 == 0 ? 'Montag': new Date().setDate(new Date().getDate() - new Date().getDay() + (new Date().getDay() == 0 ? -6:1)+7)).getHours()+':00'}</td>
<td style="text-align:center" id='${((new Date().getDay() - 2 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours()+':00')}'><img witdh="100"  height="100" src="src/model/img/${data.hourly.weathercode[data.hourly.time.indexOf(((new Date().getDay() - 2 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours()+':00'))]}.JPG"> <br> ${((new Date().getDay() - 2 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((2 - new Date().getDay()) < 1 ? 7 + (2 - new Date().getDay()) : (2 - new Date().getDay())))).getHours()+':00')}</td>
<td style="text-align:center" id='${((new Date().getDay() - 3 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours()+':00')}'><img witdh="100"  height="100" src="src/model/img/${data.hourly.weathercode[data.hourly.time.indexOf(((new Date().getDay() - 3 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours()+':00'))]}.JPG"> <br> ${((new Date().getDay() - 3 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((3 - new Date().getDay()) < 1 ? 7 + (3 - new Date().getDay()) : (3 - new Date().getDay())))).getHours()+':00')}</td>
<td style="text-align:center" id='${((new Date().getDay() - 4 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours()+':00')}'><img witdh="100"  height="100" src="src/model/img/${data.hourly.weathercode[data.hourly.time.indexOf(((new Date().getDay() - 4 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours()+':00'))]}.JPG"> <br> ${((new Date().getDay() - 4 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((4 - new Date().getDay()) < 1 ? 7 + (4 - new Date().getDay()) : (4 - new Date().getDay())))).getHours()+':00')}</td>
<td style="text-align:center" id='${((new Date().getDay() - 5 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours()+':00')}'><img witdh="100"  height="100" src="src/model/img/${data.hourly.weathercode[data.hourly.time.indexOf(((new Date().getDay() - 5 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours()+':00'))]}.JPG"> <br> ${((new Date().getDay() - 5 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((5 - new Date().getDay()) < 1 ? 7 + (5 - new Date().getDay()) : (5 - new Date().getDay())))).getHours()+':00')}</td>
<td style="text-align:center" id='${((new Date().getDay() - 6 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours()+':00')}'><img witdh="100"  height="100" src="src/model/img/${data.hourly.weathercode[data.hourly.time.indexOf(((new Date().getDay() - 6 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours()+':00'))]}.JPG"> <br> ${((new Date().getDay() - 6 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((6 - new Date().getDay()) < 1 ? 7 + (6 - new Date().getDay()) : (6 - new Date().getDay())))).getHours()+':00')}</td>
<td style="text-align:center" id='${((new Date().getDay() - 6 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours()+':00')}'><img witdh="100"  height="100" src="src/model/img/${data.hourly.weathercode[data.hourly.time.indexOf(((new Date().getDay() - 6 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours()+':00'))]}.JPG"> <br> ${((new Date().getDay() - 6 == 0) ? new Date().getHours() >=10 ? new Date().toISOString().split('T')[0]+'T'+new Date().getHours()+':00' : new Date().toISOString().split('T')[0]+'T'+'0'+new Date().getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours() >=10 ? new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).toISOString().split('T')[0]+'T'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours()+':00' : new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).toISOString().split('T')[0]+'T'+'0'+new Date(new Date().getTime() + (1000 * 60 * 60 * 24 * ((0 - new Date().getDay()) < 1 ? 7 + (0 - new Date().getDay()) : (0 - new Date().getDay())))).getHours()+':00')} </td>
`

class WeatherComponent extends HTMLElement{
    constructor() 
    {
        super()
        this.attachShadow({mode: "open"})
        
    }

    async connectedCallback() {
        console.log("connected weather-component")

        window.navigator.geolocation.getCurrentPosition(this.test.bind(this), console.log);

    }

    private render(data: WeatherData) 
    {
        const table = render(template, this.shadowRoot)
        const tbody = this.shadowRoot.querySelector("tbody")
        const row = tbody.insertRow()

        render(rowTemplate(data), row)

        const headers = this.shadowRoot.querySelectorAll('th')

        headers.forEach(header => {
            header.addEventListener('click',() => { 

                const event = new CustomEvent(DAY_SELECTED_EVENT, {detail: header.id })
                this.dispatchEvent(event)
            })
        })

        const bodys = this.shadowRoot.querySelectorAll('td')

        bodys.forEach(body => {
            body.addEventListener('click', () => {

                const event = new CustomEvent(DAY_SELECTED_EVENT, {detail: body.id })
                console.log(body.id)
                this.dispatchEvent(event)
            })
        })
    }

    columnClick(id: any)
    {
        console.log(id)
    };


    private async test(pos: GeolocationPosition)
    {
        console.log(pos.coords.longitude)
        console.log(pos.coords.latitude)
        const data = await weatherService.fetchAll(pos.coords.latitude.toString(), pos.coords.longitude.toString())
        this.render(data)
    }


}

customElements.define("weather-component", WeatherComponent)